# 索引组织表

在InnoDB中，表都是根据主键顺序组织存放的，这种存储方式的表称为索引组织表(index organized table).

在InnoDB中，每张表都有主键，如果创建表时没有显示地定义主键，则InnoDB会按照如下方式创建或选择主键：

* 判断表中是否有非空的唯一索引(Unique NOT NULL)，如果有，则该列即为主键
* 如果没有，InnoDB自动创建一个6字节大小的指针

当表中有多个非空唯一索引时，InnoDB选择建表时的第一个定义的非空唯一索引作为主键。

# InnoDB逻辑存储结构

从InnoDB的逻辑存储结构来看，所有数据都被逻辑地放到一个空间中，称之为表空间(tablespace)。表空间又由段(segment)、区(extent)、页(page)组成。页有时也被称为块(block),其结构如图所示：

![InnoDBLogicalStorageStructure](https://gitee.com/wangziming707/note-pic/raw/master/img/InnoDBLogicalStorageStructure.png)

## 表空间

表空间可以看作时InnoDB逻辑结构的最高层，所有数据都存放在表空间中。在介绍InnoDB文件时已经介绍过默认情况下InnoDB有一个共享表空间ibdata1，即所有数据都存放在这个表空间内。如果用户启用了`innodb_file_per_table`，则每张表内的数据可以单独存放到一个表空间。

如果启用了`innodb_file_per_table`的参数，那么每张表单独的表空间内只存放数据、索引、和插入缓冲Bitmap页；其他的数据，如回滚信息，插入缓冲索引页、系统事务信息，二次写缓冲等还是存放在原来的共享表空间。所以即使启用了该参数，共享表空间还是会不断地增大。

## 段

